<div class="p-6 mb-6 text-white border border-gray-700 rounded-xl" data-controller="cadena-dashboard">
  <div class="flex items-start justify-between">
    <h2 class="text-2xl font-bold leading-7 text-left text-white font-nimbus-ext"><%= cadena.name %></h2>
    <span data-action="click->cadena-dashboard#toggleDetails" class="status-pill <%= cadena.status_color %>" style="font-size:11px">
      <%= t("cadena.status.#{cadena.status}") %><%= inline_svg_tag('svg/chevron_down.svg', class: "w-3 ml-1 #{@invitation.present? ? 'rotate-180' : ''}", data: { cadena_dashboard_target: 'chevron' }) %>
    </span>
  </div>
  <div class="flex items-center justify-between mt-5" data-cadena-dashboard-target="status">
    <div class="font-manrope">
      <div class="flex items-center text-2xl font-bold <%= cadena.missing_participants.positive? ? 'text-pinky' : 'text-gray-300' %>">
        <%= cadena.participant_status %><%= inline_svg_tag('svg/users.svg', class:'w-4 ml-2 text-placeholder_gray') %>
      </div>
      <p class="text-sm lowercase text-placeholder_gray"><%= t('cadena.participants') %></p>
    </div>
    <div class="mt-2">
      <% if current_user %>
        <%= render 'cadenas/action_button', cadena: cadena %>
      <% end %>
    </div>
  </div>
  <div data-cadena-dashboard-target="details" class="<%= @invitation.present? ? '' : 'hidden' %>" id="details">
    <div class="my-5 font-manrope">
      <div class="flex items-center text-2xl font-bold text-gray-300"><%= number_to_currency(cadena.desired_installments * cadena.installment_value, precision: 0  ) %>
        <%= inline_svg_tag('svg/target.svg', class:'ml-2 text-placeholder_gray') %></div>
      <p class="text-sm lowercase text-placeholder_gray"><%= t('cadena.saving_goal') %></p>
    </div>
    <div class="flex justify-between my-5 font-manrope">
      <div>
        <div class="flex items-center text-2xl font-bold <%= cadena.started? ? 'text-white' : '' %>"><%= number_to_currency(cadena.installment_value, precision: 0) %>
          <%= inline_svg_tag('svg/calendar.svg', class:'w-4 ml-2 text-placeholder_gray') %></div>
        <p class="text-sm text-placeholder_gray"><%= cadena.periodicity == "monthly" ? "por mes" : "por quincena" %></p>
      </div>
      <div class="text-right">
        <span class="text-2xl font-bold <%= cadena.started? ? 'text-white' : '' %>">0/<%= cadena.desired_installments %></span>
        <p class="text-sm text-right lowercase text-placeholder_gray"><%= t('cadena.installments_min') %></p>
      </div>
    </div>
    <div class="flex justify-between font-manrope">
      <% if cadena.started? && current_user.member_of?(cadena) %>
        <div>
          <div class="flex items-center text-2xl font-bold text-white">
            <%= current_user&.participant(cadena).withdrawal_day.strftime('%d/%m/%y') %><%= inline_svg_tag('svg/flag.svg', class:'w-4 ml-2 text-placeholder_gray') %>
          </div>
          <p class="text-sm lowercase text-placeholder_gray"><%= t('cadena.withdrawal_day') %></p>
        </div>
        <%= render 'cadenas/next_payment_day', cadena: cadena %>
      <% else %>
        <div>
          <span class="text-2xl font-bold"><%= cadena.start_date.strftime('%d/%m/%y') %></span>
          <p class="text-sm lowercase text-placeholder_gray"><%= t('cadena.start_date') %></p>
        </div>
        <div>
          <span class="text-2xl font-bold"><%= cadena.end_date.strftime('%d/%m/%y') %></span>
          <p class="text-sm text-right lowercase text-placeholder_gray"><%= t('cadena.end_date') %></p>
        </div>
      <% end %>
    </div>
  </div>
  <% unless current_user&.member_of?(cadena) || current_user&.is_admin %>
    <%= render 'cadenas/invitations_buttons' %>
  <% end %>
</div>
