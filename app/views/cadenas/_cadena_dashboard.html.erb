<div class="p-6 mb-6 text-white border border-gray-700 rounded-xl">
  <div class="flex items-center justify-between">
    <h2 class="text-3xl font-bold leading-7 text-left text-white font-nimbus-ext"><%= cadena.name %></h2>
    <span class="px-3 py-1 ml-2 text-xs font-light uppercase border rounded-full h-fit whitespace-nowrap <%= cadena.status_color %>"><%= t("cadena.status.#{cadena.status}") %></span>
  </div>
  <div class="flex items-center justify-between my-5">
    <div class="font-manrope">
      <div class="flex items-center text-2xl font-bold <%= cadena.missing_participants.positive? ? 'text-pinky' : 'text-gray-300' %>"><%= cadena.participant_status %><%= inline_svg_tag('svg/users.svg', class:'w-4 ml-2 text-placeholder_gray') %></div>
      <p class="text-sm lowercase text-placeholder_gray"><%= t('cadena.participants') %></p>
    </div>
    <div>
      <% if cadena.pending? && (current_user.admin_of?(cadena) || current_user.is_admin) %>
        <%= link_to "Invitar más", cadena_invitations_path(cadena), class: "text-white bg-gradient-to-r from-pink-400 via-pink-500 to-pink-600 hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-pink-700 font-medium rounded-lg text-sm px-4 py-2 text-center"  %>
      <% elsif cadena.complete? && (current_user.admin_of?(cadena) || current_user.is_admin) %>
        <%= link_to "Aprobar lista", request_approval_cadena_path(cadena), data: { turbo_method: :patch }, class: "text-white bg-primary_blue hover:bg-gradient-to-br focus:ring-4 focus:outline-none focus:ring-blue-800 font-medium rounded-lg text-sm px-4 py-2 text-center"  %>
      <% elsif cadena.approval_requested? && (current_user.admin_of?(cadena) || current_user.is_admin) %>
        <%= link_to "Generar orden", assign_positions_cadena_path(cadena), data: {turbo_method: :patch }, class: "btn-warning text-sm px-4 py-2"  %>
      <% elsif @cadena.approval_requested? && !current_user.admin_of?(@cadena) && !current_user.is_admin %>
        <%= button_to "Darme de baja", remove_user_cadena_path(@cadena, current_user, format: :html), form: {data: {turbo_confirm: "Are you sure you want to leave #{@cadena.name}? This action is irreversible"}}, method: :delete, class:'btn-warning text-sm px-4 py-2 h-8 flex items-center' %>
      <% end %>
    </div>
  </div>
  <div class="my-5 font-manrope">
    <div class="flex items-center text-2xl font-bold text-gray-300"><%= number_to_currency(cadena.desired_installments * cadena.installment_value, precision: 0  ) %><%= inline_svg_tag('svg/target.svg', class:'ml-2 text-placeholder_gray') %></div>
    <p class="text-sm lowercase text-placeholder_gray"><%= t('cadena.saving_goal') %></p>
  </div>
  <div class="flex justify-between my-5 font-manrope">
    <div>
      <div class="flex items-center text-2xl font-bold <%= cadena.started? ? 'text-white' : '' %>"><%= number_to_currency(cadena.installment_value, precision: 0) %><%= inline_svg_tag('svg/calendar.svg', class:'w-4 ml-2 text-placeholder_gray') %></div>
      <p class="text-sm text-placeholder_gray"><%= cadena.periodicity == "monthly" ? "por mes" : "por quincena" %></p>
    </div>
    <div class="text-right">
      <span class="text-2xl font-bold <%= cadena.started? ? 'text-white' : '' %>">0/<%= cadena.desired_installments %></span>
      <p class="text-sm text-right lowercase text-placeholder_gray"><%= t('cadena.installments_min') %></p>
    </div>
  </div>
  <div class="flex justify-between font-manrope">
    <% if cadena.started? && current_user.member_of?(cadena) %>
      <div>
        <div class="flex items-center text-2xl font-bold text-lavender"><%= current_user&.participant(cadena).withdrawal_day.strftime('%d/%m/%y') %><%= inline_svg_tag('svg/flag.svg', class:'w-4 ml-2 text-placeholder_gray') %></div>
        <p class="text-sm lowercase text-placeholder_gray"><%= t('cadena.withdrawal_day') %></p>
      </div>
      <div class="px-2 py-1 rounded-lg bg-steel_gray">
        <span class="text-2xl font-bold leading-tight text-lavender"><%= cadena.next_payment_day(global_date ? Date.parse(global_date) : Time.zone.today) %></span>
        <div class="flex items-center justify-center">
          <p class="mb-0.5 leading-tight text-red-500 text-sm mr-1">●</p>
          <p class="text-xs leading-tight text-white"><%= t('cadena.next_payment_day') %></p>
        </div>
      </div>
    <% else %>
      <div>
        <span class="text-2xl font-bold"><%= cadena.start_date.strftime('%d/%m/%y') %></span>
        <p class="text-sm lowercase text-placeholder_gray"><%= t('cadena.start_date') %></p>
      </div>
      <div>
        <span class="text-2xl font-bold"><%= cadena.end_date.strftime('%d/%m/%y') %></span>
        <p class="text-sm text-right lowercase text-placeholder_gray"><%= t('cadena.end_date') %></p>
      </div>
    <% end %>
  </div>
  <% unless current_user&.member_of?(cadena) || current_user&.is_admin %>
    <div class="flex flex-col mt-5 space-y-5">
      <%= link_to 'Aceptar invitacion', new_user_registration_path(params: { token: params[:token] }), class: 'text-white btn-primary w-full text-center' %>
      <%= link_to 'Rechazar invitacion', root_url, class: 'btn-danger w-full text-center' %>
    </div>
  <% end %>
</div>
